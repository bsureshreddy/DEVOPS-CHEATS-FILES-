/*
Name   -    PER_PERSON_NAMES_F
Number -    PER_ALL_PEOPLE_F
Email  -    PER_EMAIL_ADDRESSES
--DOB    -    PER_ALL_PEOPLE_F
--Gender -    PER_ALL_PEOPLE_F
NI     -    PER_NATIONAL_IDENTIFIERS

Job        -  PER_JOBS_F   -  	no
Grade      -  PER_GRADES_F
Location   -  HR_ALL_LOCATIONS
Department -  HR_ALL_ORGANIZATION_UNITS_F
Position   -  PER_POSITIONS_F, HR_ALL_POSITIONS */


SELECT
  PAPF.PERSON_NUMBER,
  PPNF.DISPLAY_NAME,
  PNI.NATIONAL_IDENTIFIER_NUMBER,
  PEA.EMAIL_ADDRESS,
  PJFT.NAME JOB_NAME
FROM
  PER_ALL_PEOPLE_F PAPF,
  PER_PERSON_NAMES_F PPNF,
  PER_NATIONAL_IDENTIFIERS PNI,
  PER_EMAIL_ADDRESSES PEA,
  PER_ALL_ASSIGNMENTS_M PAAM,
  PER_JOBS_F_TL PJFT
WHERE
    PAPF.PERSON_ID = PPNF.PERSON_ID
AND PAPF.PERSON_ID = PNI.PERSON_ID	
AND PAPF.PERSON_ID = PEA.PERSON_ID
AND PAPF.PERSON_ID = PAAM.PERSON_ID   -- Person to Assignment Join
AND PAAM.JOB_ID    = PJFT.JOB_ID      -- Assignment to Job Join
AND NAME_TYPE = 'US'
-- Date Tracking Conditions for the _F and _M tables to get the Latest Record
AND TRUNC(SYSDATE) BETWEEN PAPF.EFFECTIVE_START_DATE AND PAPF.EFFECTIVE_END_DATE
AND TRUNC(SYSDATE) BETWEEN PPNF.EFFECTIVE_START_DATE AND PPNF.EFFECTIVE_END_DATE
AND TRUNC(SYSDATE) BETWEEN PAAM.EFFECTIVE_START_DATE AND PAAM.EFFECTIVE_END_DATE
AND TRUNC(SYSDATE) BETWEEN PJFT.EFFECTIVE_START_DATE AND PJFT.EFFECTIVE_END_DATE
AND PAPF.PERSON_NUMBER = NVL(:PERSON_NUMBER,PAPF.PERSON_NUMBER)

